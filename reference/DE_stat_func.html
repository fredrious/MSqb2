<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform Differential Expression Analysis Using LIMMA — DE_stat_func • MSqb2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform Differential Expression Analysis Using LIMMA — DE_stat_func"><meta name="description" content="This function performs differential expression analysis on MS data using limma (Linear Models for Microarray Data) package.
It supports a wide range of experimental designs, including handling of technical replicates, blocking factors, and the application of contrasts
to identify differentially expressed proteins or peptides."><meta property="og:description" content="This function performs differential expression analysis on MS data using limma (Linear Models for Microarray Data) package.
It supports a wide range of experimental designs, including handling of technical replicates, blocking factors, and the application of contrasts
to identify differentially expressed proteins or peptides."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MSqb2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform Differential Expression Analysis Using LIMMA</h1>

      <div class="d-none name"><code>DE_stat_func.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs differential expression analysis on MS data using limma (Linear Models for Microarray Data) package.
It supports a wide range of experimental designs, including handling of technical replicates, blocking factors, and the application of contrasts
to identify differentially expressed proteins or peptides.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DE_stat_func</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  sample <span class="op">=</span> <span class="st">"SampleID"</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Protein"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>  model.formula <span class="op">=</span> <span class="st">"~ 0 + Condition"</span>,</span>
<span>  sva.obj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  techrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  limma.trend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  limma.robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  limma.winsor.tail.p <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  time.course <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  spline.df <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  removeTotalMissing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pairwise.contrasts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pairwise.denominator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"wildtype"</span>, <span class="st">"wild-type"</span>, <span class="st">"cntrl"</span>, <span class="st">"control"</span>, <span class="st">"ctl"</span>,</span>
<span>    <span class="st">"untreated"</span><span class="op">)</span>,</span>
<span>  manual.contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  choose.contrasts <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  make.complex.contrasts <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  blocking.parameter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reverse.contrasts <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showWarnings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prefix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  suffix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rmSingleShotProteins <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add.vs.inContrast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>A <code>data.table</code> containing the MS data. The table should include columns for samples, variables (e.g., proteins),
and values (e.g., abundances).</p></dd>


<dt id="arg-sample">sample<a class="anchor" aria-label="anchor" href="#arg-sample"></a></dt>
<dd><p>A character string specifying the column name that contains sample identifiers. Default is <code>"SampleID"</code>.</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>A character string specifying the column name that contains the variables of interest (e.g., <code>"Protein"</code>). Default is <code>"Protein"</code>.</p></dd>


<dt id="arg-value">value<a class="anchor" aria-label="anchor" href="#arg-value"></a></dt>
<dd><p>A character string specifying the column name that contains the values to be analyzed (e.g., <code>"Abundance"</code>). Default is <code>"Abundance"</code>.</p></dd>


<dt id="arg-model-formula">model.formula<a class="anchor" aria-label="anchor" href="#arg-model-formula"></a></dt>
<dd><p>A character string specifying the model formula to be used in the analysis. Default is <code>"~ 0 + Condition"</code>.</p></dd>


<dt id="arg-sva-obj">sva.obj<a class="anchor" aria-label="anchor" href="#arg-sva-obj"></a></dt>
<dd><p>An optional <code>sva</code> object for batch correction. Default is <code>NULL</code>.</p></dd>


<dt id="arg-techrep">techrep<a class="anchor" aria-label="anchor" href="#arg-techrep"></a></dt>
<dd><p>A character string specifying the column name that contains technical replicates. If provided, these will be used as blocking factors. Default is <code>NULL</code>.</p></dd>


<dt id="arg-limma-trend">limma.trend<a class="anchor" aria-label="anchor" href="#arg-limma-trend"></a></dt>
<dd><p>Logical or character. If <code>TRUE</code>, trend fitting is applied; if a character, it specifies the column name to be used for trend fitting. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-limma-robust">limma.robust<a class="anchor" aria-label="anchor" href="#arg-limma-robust"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, robust fitting is applied in the eBayes step. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-limma-winsor-tail-p">limma.winsor.tail.p<a class="anchor" aria-label="anchor" href="#arg-limma-winsor-tail-p"></a></dt>
<dd><p>Logical or numeric. If <code>FALSE</code>, no winsorization is applied; if numeric, specifies the tail probability for winsorization. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-time-course">time.course<a class="anchor" aria-label="anchor" href="#arg-time-course"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, a time course analysis is performed using spline regression. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-spline-df">spline.df<a class="anchor" aria-label="anchor" href="#arg-spline-df"></a></dt>
<dd><p>Integer. Degrees of freedom for spline regression in time course analysis. Default is <code>4</code>.</p></dd>


<dt id="arg-removetotalmissing">removeTotalMissing<a class="anchor" aria-label="anchor" href="#arg-removetotalmissing"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, rows with all missing values are removed from the analysis. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-pairwise-contrasts">pairwise.contrasts<a class="anchor" aria-label="anchor" href="#arg-pairwise-contrasts"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, all pairwise contrasts between conditions are computed. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-pairwise-denominator">pairwise.denominator<a class="anchor" aria-label="anchor" href="#arg-pairwise-denominator"></a></dt>
<dd><p>Character vector. Specifies the condition levels to be used as denominators in pairwise contrasts. Default includes <code>"wt"</code>, <code>"wildtype"</code>, <code>"control"</code>, etc.</p></dd>


<dt id="arg-manual-contrasts">manual.contrasts<a class="anchor" aria-label="anchor" href="#arg-manual-contrasts"></a></dt>
<dd><p>A list of manual contrasts to be applied. Default is <code>NULL</code>.</p></dd>


<dt id="arg-choose-contrasts">choose.contrasts<a class="anchor" aria-label="anchor" href="#arg-choose-contrasts"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, allows manual selection of contrasts from a list. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-make-complex-contrasts">make.complex.contrasts<a class="anchor" aria-label="anchor" href="#arg-make-complex-contrasts"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, prompts the user to create complex contrasts. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-blocking-parameter">blocking.parameter<a class="anchor" aria-label="anchor" href="#arg-blocking-parameter"></a></dt>
<dd><p>A character string specifying the column name for blocking factors, typically technical replicates. Default is <code>NULL</code>.</p></dd>


<dt id="arg-reverse-contrasts">reverse.contrasts<a class="anchor" aria-label="anchor" href="#arg-reverse-contrasts"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, reverses the direction of the contrasts. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-showwarnings">showWarnings<a class="anchor" aria-label="anchor" href="#arg-showwarnings"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, warnings are shown during execution. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-prefix">prefix<a class="anchor" aria-label="anchor" href="#arg-prefix"></a></dt>
<dd><p>A character string to prefix the output filenames. Default is <code>NULL</code>.</p></dd>


<dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>A character string to suffix the output filenames. Default is <code>NULL</code>.</p></dd>


<dt id="arg-rmsingleshotproteins">rmSingleShotProteins<a class="anchor" aria-label="anchor" href="#arg-rmsingleshotproteins"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, proteins with only one peptide are removed from the analysis. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-add-vs-incontrast">add.vs.inContrast<a class="anchor" aria-label="anchor" href="#arg-add-vs-incontrast"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the contrasts are labeled with "vs." between conditions. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>A character string specifying the output directory for saving results. Default is the current working directory.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the underlying LIMMA functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p><code>"fit_eb"</code>: The fitted model after applying eBayes.</p></li>
<li><p><code>"fit_residuals"</code>: The residuals of the fit.</p></li>
<li><p><code>"fit0"</code>: The initial fitted model before applying contrasts.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>DE_stat_func</code> function is designed to handle complex experimental designs typical in mass spectrometry-based proteomics studies.
It supports:</p>
<ul><li><p><strong>Technical Replicates</strong>: When <code>techrep</code> is provided, the function accounts for repeated measures by using the <code>duplicateCorrelation</code> method from LIMMA.</p></li>
<li><p><strong>Time Course Analysis</strong>: If <code>time.course</code> is <code>TRUE</code>, the function performs spline regression to model the effect of time.</p></li>
<li><p><strong>Contrast Definitions</strong>: Users can define contrasts manually or choose from pairwise contrasts. Complex contrasts, such as average or delta-delta contrasts, can also be generated.</p></li>
</ul><p>This function is suitable for both differential expression analysis in standard proteomics experiments and more complex designs involving time courses or technical replicates.
When working with experiments that have potential batch effects, users can incorporate surrogate variable analysis (<code>sva.obj</code>) to correct for these.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Farhad Shakeri.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

